<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Asignar usuario a proyecto</title>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
</head>
<body>
<h1>Asignar usuario a proyecto</h1>
<div id="log"></div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyDTuzGWaKLFzjHPfpVSQDzkSZeIA-Nv-4s",
  authDomain: "agilify-c9abf.firebaseapp.com",
  projectId: "agilify-c9abf",
  storageBucket: "agilify-c9abf.firebasestorage.app",
  messagingSenderId: "115735342206",
  appId: "1:115735342206:web:1ff5368de61190dac53c2f"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

const logDiv = document.getElementById("log");

function log(msg) {
  console.log(msg);
  logDiv.innerHTML += `<p>${msg}</p>`;
}

(async () => {
  const uid = prompt("UID del usuario:");
  const projectId = prompt("ID del proyecto:");

  if (!uid || !projectId) {
    log("❌ UID o ProjectID faltantes");
    return;
  }

  const projectRef = db.collection('projects').doc(projectId);

  try {
    const doc = await projectRef.get();
    if (!doc.exists) {
      log(`❌ El proyecto ${projectId} no existe`);
      return;
    }

    await projectRef.update({
      [`members.${uid}`]: true
    });

    log(`✅ Usuario ${uid} asignado al proyecto ${projectId}`);
  } catch (err) {
    console.error(err);
    log(`❌ Error: ${err.message}`);
  }
})();
</script>
</body>
</html>
